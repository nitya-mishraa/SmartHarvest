{% extends 'base.html' %}

{% block additional_css %}
<style>
    .recommended-crop {
        padding: 20px;
        background-color: #f8f9fa;
        border-radius: 10px;
        margin-top: 20px;
        border-left: 5px solid #28a745;
    }
    
    .recommendation-image {
        max-height: 200px;
        object-fit: cover;
    }
</style>
{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header bg-success text-white">
                <h3 class="mb-0"><i class="fas fa-seedling me-2"></i>{{ translate('crop_recommendation_system') }}</h3>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-lg-6">
                        <p class="lead">{{ translate('crop_recommendation_description') }}</p>
                        
                        <div class="alert alert-info" role="alert">
                            <i class="fas fa-info-circle me-2"></i>{{ translate('soil_test_info') }}
                        </div>
                        
                        <form method="POST" action="{{ url_for('crop_recommendation') }}" id="cropRecommendationForm">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="nitrogen" class="form-label">{{ translate('nitrogen_content_label') }}</label>
                                    <input type="number" class="form-control" id="nitrogen" name="nitrogen" required min="0" max="500" step="0.01" placeholder="{{ translate('nitrogen_placeholder') }}">
                                </div>
                                
                                <div class="col-md-6">
                                    <label for="phosphorus" class="form-label">{{ translate('phosphorus_content_label') }}</label>
                                    <input type="number" class="form-control" id="phosphorus" name="phosphorus" required min="0" max="500" step="0.01" placeholder="{{ translate('phosphorus_placeholder') }}">
                                </div>
                                
                                <div class="col-md-6">
                                    <label for="potassium" class="form-label">{{ translate('potassium_content_label') }}</label>
                                    <input type="number" class="form-control" id="potassium" name="potassium" required min="0" max="500" step="0.01" placeholder="{{ translate('potassium_placeholder') }}">
                                </div>
                                
                                <div class="col-md-6">
                                    <label for="temperature" class="form-label">{{ translate('temperature_content_label') }}</label>
                                    <input type="number" class="form-control" id="temperature" name="temperature" required min="0" max="50" step="0.1" placeholder="{{ translate('temperature_placeholder') }}">
                                </div>
                                
                                <div class="col-md-6">
                                    <label for="humidity" class="form-label">{{ translate('humidity_content_label') }}</label>
                                    <input type="number" class="form-control" id="humidity" name="humidity" required min="0" max="100" step="0.1" placeholder="{{ translate('humidity_placeholder') }}">
                                </div>
                                
                                <div class="col-md-6">
                                    <label for="ph" class="form-label">{{ translate('ph_content_label') }}</label>
                                    <input type="number" class="form-control" id="ph" name="ph" required min="0" max="14" step="0.1" placeholder="{{ translate('ph_placeholder') }}">
                                </div>
                                
                                <div class="col-md-6">
                                    <label for="rainfall" class="form-label">{{ translate('rainfall_content_label') }}</label>
                                    <input type="number" class="form-control" id="rainfall" name="rainfall" required min="0" max="5000" step="0.1" placeholder="{{ translate('rainfall_placeholder') }}">
                                </div>
                                
                                <div class="col-12 mt-4">
                                    <div class="d-grid">
                                        <button type="submit" class="btn btn-success">
                                            <i class="fas fa-search me-2"></i>{{ translate('get_crop_recommendation') }}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    
                    <div class="col-lg-6">
                        <div class="text-center mb-4">
                            <img src="https://pixabay.com/get/g357fbe7b44315dfa379730901c99291606c3d983e3d8b11631218a235b0d1559c6c43b5e8550bc8d7dc5b0eb83ffd803c99c551960ac813433d3c6a88b93c5ac_1280.jpg" alt="Crop Growth Stages" class="img-fluid rounded">
                        </div>
                        
                        {% if prediction %}
                        <div class="recommended-crop">
                            <h4 class="text-success mb-3">
                                <i class="fas fa-leaf me-2"></i>{{ translate('recommended_crop_label') }}: {{ prediction }}
                            </h4>
                            
                            <p>{{ translate('crop_recommendation_result_text') }} <strong>{{ prediction }}</strong> {{ translate('for_optimal_yield') }}.</p>
                            
                            <div class="mt-3">
                                <h5>{{ translate('why_this_crop') }}</h5>
                                <ul>
                                    <li>{{ translate('suitable_soil_nutrients') }} (N: {{ request.form.get('nitrogen') }}, P: {{ request.form.get('phosphorus') }}, K: {{ request.form.get('potassium') }})</li>
                                    <li>{{ translate('compatible_climate') }} ({{ translate('temperature') }}: {{ request.form.get('temperature') }}Â°C, {{ translate('humidity') }}: {{ request.form.get('humidity') }}%)</li>
                                    <li>{{ translate('appropriate_ph_rainfall') }} ({{ translate('ph') }}: {{ request.form.get('ph') }}) {{ translate('and') }} {{ translate('rainfall') }}: ({{ request.form.get('rainfall') }} mm)</li>
                                </ul>
                            </div>
                            
                            <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-3">
                                <a href="{{ url_for('fertilizer_recommendation') }}" class="btn btn-outline-primary">
                                    <i class="fas fa-flask me-2"></i>{{ translate('get_fertilizer_recommendations') }}
                                </a>
                            </div>
                        </div>
                        {% elif error %}
                        <div class="alert alert-danger" role="alert">
                            <i class="fas fa-exclamation-triangle me-2"></i>{{ error }}
                        </div>
                        {% else %}
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">{{ translate('how_it_works') }}</h5>
                                <ol>
                                    <li>{{ translate('enter_nutrients') }}</li>
                                    <li>{{ translate('add_environmental_parameters') }}</li>
                                    <li>{{ translate('ai_analyzes_data') }}</li>
                                    <li>{{ translate('get_recommendation') }}</li>
                                </ol>
                                <p>{{ translate('model_training_info') }}</p>
                            </div>
                        </div>
                        
                        <div class="card mt-3">
                            <div class="card-body">
                                <h5 class="card-title">{{ translate('where_to_get_soil_parameters') }}</h5>
                                <ul>
                                    <li>{{ translate('local_agricultural_centers') }}</li>
                                    <li>{{ translate('mobile_soil_testing') }}</li>
                                    <li>{{ translate('krishi_vigyan_kendras') }}</li>
                                    <li>{{ translate('home_testing_kits') }}</li>
                                </ul>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block additional_js %}
<script src="{{ url_for('static', filename='js/crop_recommendation.js') }}"></script>
{% endblock %}
